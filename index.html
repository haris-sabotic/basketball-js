<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            font-family: sans-serif;
        }


        body {
            display: flex;
            height: 100vh;
            width: 100vw;
            flex-direction: column;
            justify-content: center;
        }

        .login-form,
        .register-form {
            display: flex;
            flex-direction: column;

            margin: 0 30px;
        }

        h1 {
            text-align: center;
            margin-bottom: 40px;
        }

        input {
            margin-bottom: 20px;
            border: 1px solid black;
            border-radius: 5px;
            padding: 10px 20px;
        }

        label {
            margin-bottom: 5px;
        }

        button {
            margin: 20px 0;
            border: 1px solid black;
            border-radius: 5px;
            padding: 10px 20px;
            font-weight: bold;
            background-color: lightgray;
            color: black;
        }

        .login-instead,
        .register-instead {
            text-align: center;
            padding: 5px;
            color: rgb(26, 92, 92);
        }

        .hidden {
            display: none;
        }
    </style>
</head>

<body>
    <div class="login-form">
        <h1>PRIJAVA</h1>

        <label for="login-username">Instagram korisničko ime:</label>
        <input type="text" name="username" id="login-username">

        <label for="login-password">Šifra:</label>
        <input type="password" name="password" id="login-password">

        <button type="button">PRIJAVI SE</button>

        <p class="register-instead">Registruj se</p>
    </div>

    <div class="register-form hidden">
        <h1>REGISTRACIJA</h1>

        <label for="register-username">Instagram korisničko ime:</label>
        <input type="text" name="username" id="register-username">

        <label for="register-email">Email:</label>
        <input type="email" name="email" id="register-email">

        <label for="register-password">Šifra:</label>
        <input type="password" name="password" id="register-password">

        <button type="button">REGISTRUJ SE</button>

        <p class="login-instead">Prijavi se</p>
    </div>

    <script>
        let loginForm = document.querySelector(".login-form");
        let registerForm = document.querySelector(".register-form");

        document.querySelector(".register-instead").addEventListener("click", () => {
            loginForm.classList.add("hidden");
            registerForm.classList.remove("hidden");
        });
        document.querySelector(".login-instead").addEventListener("click", () => {
            registerForm.classList.add("hidden");
            loginForm.classList.remove("hidden");
        });

		const WS = new WebSocket("ws://84.247.177.105:8000");

        function SEND_WS_MESSAGE(tag, msg) {
            WS.send(JSON.stringify({ tag, msg }));
        }

        WS.addEventListener("open", (event) => {
            // Connection opened
        });

        WS.addEventListener("message", (event) => {
            let message = JSON.parse(event.data);

            console.log(message);

            if (message.tag == "register") {
                if (message.data.success) {
                    window.location.href = `/game.html?token=${message.data.token}`;
                } else {
                    alert(message.data.message);
                }
            } else if (message.tag == "login") {
                if (message.data.success) {
                    window.location.href = `/game.html?token=${message.data.token}`;
                } else {
                    alert(message.data.message);
                }
            }
        });

        document.querySelector(".register-form > button").addEventListener("click", () => {
            let username = document.querySelector("#register-username").value;
            let email = document.querySelector("#register-email").value;
            let password = document.querySelector("#register-password").value;

            SEND_WS_MESSAGE("register", {
                username,
                email,
                password,
            });
        });

        document.querySelector(".login-form > button").addEventListener("click", () => {
            let username = document.querySelector("#login-username").value;
            let password = document.querySelector("#login-password").value;

            SEND_WS_MESSAGE("login", {
                username,
                password,
            });
        });
    </script>
</body>

</html>
